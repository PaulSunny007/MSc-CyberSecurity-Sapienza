# Malware Analysis and Incident Forensics - Theory

## Lesson 1 - Introduction

General news about malware-based attacks:
- [Yahoo 'state' hackers stole data from 500 million users](https://www.bbc.com/news/world-us-canada-37447016)
- [Brian Krebs site hit with 665 Gbps DDoS attack; Largest Internet has ever seen](https://www.hackread.com/brian-krebs-website-665-gbps-ddos-attack/)
- [The Equifax data breach exposes extremely
sensitive data from 143 million consumers](https://www.bloomberg.com/news/articles/2017-09-07/equifax-says-cyber-intrusion-affected-143-million-customers)

The data breach market is ourishing. Black markets provide advanced tools for data search. Prices are extremely variable depending on the specific product.

The topic of this course revolves around *Cyber Security*  
“preservation of confidentiality, integrity and availability of information in the Cyberspace” (ISO-27000)  
Cyberspace is “the complex environment resulting from the interaction of people, software and services on the Internet by means of technology devices and networks connected to it, which does not exist in any physical form” (NIST)

The role of malware  
![malware types](https://github.com/edoardottt/MSc-CyberSecurity-Sapienza/blob/main/Malware-Analysis-and-Incident-Forensics/resources/images/01-malware-types.jpg)  
Source: https://www.gdatasoftware.com/blog/2018/09/31037-malware-figures-first-half-2018-danger-web

The **Attack Killchain** is list made of 8 points explaining the anatomy of a malware:  
- Reconnaissance
- Weaponization
- Delivery
- Exploitation
- Persistence
- Callback
- Data exfiltration
- Lateral spread

In this course we will go deep in the last 4 points.

Expected beaviours:
- Persistence
    - The malware installs itself in the system
    - It performs actions to guarantee its survivability to reboots, inspections, etc.
    - Often modifies the OS configuration
    - Changes are hidden
- Uniqueness
    - Malware is often incompatible with itself
    - Multiple concurrent executions are meaningless
      - Or sometimes dangerous for the malware itself
      - Think about two ransomware instances competing for the same resources
    - Checks at startup guarantee te execution of a single copy
- Obfuscation and evasion
    - Malware will try to hide its presence and its e ects to stay undetected as long as possible
    - It may inject code in the processes to conceal its real identity
    - It may mangle its internal code to hide easily discoverable hints of its malicious nature
    - It may leverage techniques to hamper the possibility to correctly analyze its behavior
- Fingerprinting
    - Malware will inspect the infected system and collect information about it
    - Information can be used to “publicize” its presence to a remote server
    - Sometimes the malware may locally use this information to control its own behavior
        - e.g. fully deploy its payload only in a specific country, or at a specific date
- Communication
    - Malware often interact with external command & control services to
        - receive instructions and commands
        - update its internal components
        - exfiltrate data
    - Communication may use an impressively heterogeneous set of links
    - Data on channels is often obfuscated

## Lesson 2 - The Attack Killchain part 1

The 5 Ws of a CyberAttack:

| W | Answer |
|-----------------|--------------|
| Who | Targets: Single users, Industries, Financial, Health, Energy, IT, Manufacture, Public agencies, MIL & Defense.  Threats: Hackers, Activists, Undercover operations, Industrial espionage, Cyberterrorists, Cyberwarfare.  Other actors: Research (academia, agencies, individuals), Security firms and experts, White-hat hackers, CERTs and government agencies, MIL & Defense. |
| What | Activities of interest: Data theft, Machine control, Financial fraud, Disruption of operation, Defacing, Physical damage. |
| Why | Motivations: Financial gain, Politics/ Hacktivism, Doxing, Terrorism / Cyberwarfare, Revenge |
| Where and When  | https://cybermap.kaspersky.com |

The evolution of Malware:
- 1998 CIH (https://en.wikipedia.org/wiki/CIH_(computer_virus))
- 2001 Code Red (https://en.wikipedia.org/wiki/Code_Red_(computer_worm))
- 2003 Slammer (https://en.wikipedia.org/wiki/SQL_Slammer)
- 2004 MyDoom (https://en.wikipedia.org/wiki/Mydoom)
- 2005 PoisonIvy (https://en.wikipedia.org/wiki/PoisonIvy_(trojan))
- 2007 Zeus (https://en.wikipedia.org/wiki/Zeus_(malware))
- 2008 Agent.btz (https://en.wikipedia.org/wiki/Agent.BTZ)
- 2010 Stuxnet (https://en.wikipedia.org/wiki/Stuxnet)
- 2010 DigiNotar (https://en.wikipedia.org/wiki/DigiNotar)
- 2012 Flame (https://en.wikipedia.org/wiki/Flame_(malware))
- 2017 Wannacry (https://en.wikipedia.org/wiki/WannaCry_ransomware_attack)
- 2017 Petya (https://en.wikipedia.org/wiki/Petya_(malware))
- A growing trend (http://www.informationisbeautiful.net/visualizations/worlds-biggest-data-breaches-hacks/)

The production chain of malware:
1. Malware coder writes malicious software to exploit a computer vunerability and installs a trojan.
2. Victim infected with credential-stealing malware.
3. Banking credentials siphoned.
4. Hacker retrieves banking credentials.
5. Remote access to compomised computers.
6. Hacker ogs into victim's online bank account
7. Money transferred to mule.
8. Money transferred from mule to organizers.

Read also the [Verizon 2021 Data breach investigations report](https://www.verizon.com/business/resources/reports/dbir/2021/).
